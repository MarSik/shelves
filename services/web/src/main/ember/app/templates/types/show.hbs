{{partial '_itemheader'}}

<h3>Additional properties</h3>

<ul class="small-block-grid-2 large-block-grid-6">
    {{#each property in model.properties itemController='types/property'}}
    <li>{{#confirm-button action='removeProperty' param=model param2=property.model}}{{property.model.niceName}}: {{property.value}}{{/confirm-button}}</li>
    {{/each}}
</ul>

{{ember-selectize
content=sortedProperties
optionValuePath="content.id"
optionLabelPath="content.niceName"
selection=propertyToAdd
placeholder="Select a property" }}

{{input type='text' value=propertyValueToAdd}}

<button {{action 'addProperty' model propertyToAdd propertyValueToAdd}}>{{fa-icon 'plus'}} Add</button>

<h3>Available lots</h3>
<table>
    <thead>
    <tr>
        <th>Source</th>
        <th colspan="4">Box / Project</th>
    </tr>
    <tr>
        <th>SKU</th>
        <th>Cnt.</th>
        <th>Price</th>
        <th>w/ Vat</th>
        <th>Vat %</th>
    </tr>
    </thead>
    {{#each lot in lots}}
    <tbody>
    <tr>
        <td>
            {{#link-to 'transactions.show' lot.purchase.transaction}}{{lot.purchase.transaction.source.name}}{{/link-to}}
        </td>
        <td colspan="4">
            {{#if lot.canBeAssigned}}
            {{fa-icon 'cube'}} {{#link-to 'boxes.show' lot.location}}{{lot.location.fullName}}{{/link-to}}
            {{/if}}
            {{#if lot.canBeSoldered}}
            {{fa-icon 'flask'}} {{#link-to 'projects.show' lot.usedBy.project}}{{lot.usedBy.project.name}}{{/link-to}}
            {{/if}}
            {{#if lot.canBeUnsoldered}}
            {{fa-icon 'download-alt'}} {{#link-to 'projects.show' lot.usedBy.project}}{{lot.usedBy.project.name}}{{/link-to}}
            {{/if}}
        </td>
    </tr>
    <tr>
        <td class="sku">
            {{lot.purchase.sku}}
        </td>
        <td class="count">
            {{lot.count}}
        </td>
        <td class="price">
            {{lot.purchase.priceWithoutVat}}
        </td>
        <td class="vat-included">
            {{lot.purchase.priceWithVat}}
        </td>
        <td class="vat">
            {{lot.purchase.vat}}
        </td>
    </tr>
    </tbody>
    {{/each}}
</table>

<button {{action 'addSticker' model}}>{{fa-icon 'qrcode'}} Add to sticker list</button>