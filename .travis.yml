language: java
jdk:
  - oraclejdk8

services:
  - memcached

addons:
  mariadb: '10.1'

before_install:
  - git clone https://github.com/MarSik/jackson-databind.git
  - pushd jackson-databind && git checkout improve-unresolved-handling-2.6 && mvn clean install && popd
  - git clone https://github.com/pauloubuntu/identicon.git
  - pushd identicon && mvn clean install && popd

before_script:
  - mysql -e 'create database elshelves_unittest;'
 
deploy:
  provider: releases
    api_key:
      secure: "IVsGqfWGdgy1mgZrifhV4+m6dwZuRGy8Xh90xbex/4aN0jr4ZTw/nyBti5WUu4vIz1PYs6Q2Xjsyv7U9FS/OAxc0beHwOYJUMP0hkI0ZnZQh0uoOe8Osh+09mZFMJB2/u/akDpvfbOE99MClaebTCWKK70jWeH0GUNexrEIoHfg="
  file:
    - backend/server/target/server-1.0-SNAPSHOT.war
    - web/target/web-1.0-SNAPSHOT.war
  skip_cleanup: true
  on:
    tags

